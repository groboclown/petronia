---
schema-version: v1

name: petronia.core.api.native
version: [1, 0, 0]
type: api

about: The Native Process event details.
description: >
  A well-defined list of events that are received and sent by the Native process.
  The native process defines cross-platform actions for interacting with the
  user.  This handles translation services and UI interactivity.
licenses:
  - MIT
authors:
  - Petronia Project
depends: []
default:
  name: petronia.core.impl.native
  minimum: [1, 0, 0]

events:
  register-translation:
    description: >
      Allows an extension to add additional messages, new translation languages,
      or override existing ones.
    priority: normal
    send-access: public
    receive-access: implementations
    fields:
      identifier:
        description: >
          The requested translation fragment ID.  Should uniquely identify this fragment of the
          registered translation.  This value is used to report on success or failure of the
          registration.
        type: string
        min-length: 3
        max-length: 200
      locale_code:
        description: standard language and locale identifier.
        type: string
        min-length: 1
        max-length: 10
      catalog_name:
        description: name of the catalog registered.
        type: string
        min-length: 3
        max-length: 255
      messages:
        description: list of translations to add to the catalog.
        type: array
        value-type:
          type: reference
          ref: translated-message

  "register-translation:success":
    description: >
      Report that the translation was successfully registered
    priority: normal
    send-access: implementations
    receive-access: public
    fields:
      identifier:
        description: The requested translation fragment ID.
        type: string
        min-length: 3
        max-length: 200

  "register-translation:failed":
    description: >
      Report that the translation failed to be registered
    priority: normal
    send-access: implementations
    receive-access: public
    fields:
      identifier:
        description: The requested translation fragment ID.
        type: string
        min-length: 3
        max-length: 200
      error:
        type: reference
        ref: error

references:
  error:
    type: structure
    description: A failure
    fields:
      identifier:
        type: string
        min-length: 2
        max-length: 255
        description: The identifier that uniquely defines this error.
      source:
        type: string
        optional: true
        description: The source of the error, if known.
      message:
        type: string
        description: A localizable message.
      arguments:
        type: array
        description: arguments for the message.
        value-type:
          type: selector
          type-mapping:
            string:
              type: string
            int:
              type: int
            float:
              type: float

  translated-message:
    type: structure
    description: a translation of a message
    fields:
      identifier:
        type: string
        min-length: 1
        max-length: 60000
      arguments:
        type: array
        description: argument keys for the message.
        value-type:
          type: string
      translation:
        type: string
        description: the translation of the message into the owning translation's locale
